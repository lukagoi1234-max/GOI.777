<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>777 Slot Machine</title>
  <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a2e;
            color: white;
            text-align: center;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: #16213e;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            color: #f9c74f;
            margin-bottom: 30px;
        }
        
        .balance {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .slot-machine {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        
        .reel {
            width: 100px;
            height: 150px;
            background-color: #e94560;
            margin: 0 10px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .reel-content {
            position: absolute;
            width: 100%;
            transition: top 0.5s cubic-bezier(0.17, 0.67, 0.12, 0.99);
        }
        
        .symbol {
            height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 60px;
        }
        
        .controls {
            margin: 30px 0;
        }
        
        button {
            background-color: #f9c74f;
            color: #1a1a2e;
            border: none;
            padding: 12px 30px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s;
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        button:disabled {
            background-color: #555;
            cursor: not-allowed;
        }
        
        .win-message {
            font-size: 24px;
            color: #4cc9f0;
            height: 30px;
            margin: 15px 0;
            min-height: 30px;
        }
        
        .bet-controls {
            margin: 20px 0;
        }
        
        .bet-btn {
            padding: 8px 15px;
            margin: 0 5px;
            font-size: 16px;
        }
        
        .win-animation {
            animation: winPulse 0.5s 3;
        }
        
        @keyframes winPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
  <div class="container">
   <h1>GOI 777 </h1>
   <div class="balance">
    Balance: $<span id="balance">1000</span>
   </div>
   <div class="bet-controls">
    <button class="bet-btn" onclick="changeBet(-10)">-10</button> 
    <button class="bet-btn" onclick="changeBet(-1)">-1</button> 
    Bet: $<span id="current-bet">10</span> 
    <button class="bet-btn" onclick="changeBet(1)">+1</button> 
    <button class="bet-btn" onclick="changeBet(10)">+10</button>
   </div>
   <div class="slot-machine">
    <div class="reel" id="reel1">
     <div class="reel-content" id="reel1-content"></div>
    </div>
    <div class="reel" id="reel2">
     <div class="reel-content" id="reel2-content"></div>
    </div>
    <div class="reel" id="reel3">
     <div class="reel-content" id="reel3-content"></div>
    </div>
   </div>
   <div class="win-message" id="win-message"></div>
   <div class="controls">
    <button id="spin-btn" onclick="spin()">SPIN</button>
   </div>
  </div>
  <script>
        const symbols = ['🍀', '🍇', '🔔', '🎰'];
        let balance = 1000;
        let currentBet = 10;
        let isSpinning = false;
        let winStreak = 0;
        
        // Optimized reel initialization with cached elements
        const reels = [
            { element: document.getElementById('reel1-content'), position: 0 },
            { element: document.getElementById('reel2-content'), position: 0 },
            { element: document.getElementById('reel3-content'), position: 0 }
        ];
        
        // Initialize reels with symbols
        function initializeReels() {
            reels.forEach(reel => {
                reel.element.innerHTML = '';
                
                // Add symbols for smooth spinning
                for (let j = 0; j < 2; j++) { // Reduced from 3 to 2 copies for performance
                    symbols.forEach(symbol => {
                        const symbolDiv = document.createElement('div');
                        symbolDiv.className = 'symbol';
                        symbolDiv.textContent = symbol;
                        reel.element.appendChild(symbolDiv);
                    });
                }
                
                // Set initial position to show a random symbol
                const randomOffset = Math.floor(Math.random() * symbols.length) * 150;
                reel.element.style.top = `-${randomOffset}px`;
                reel.position = randomOffset;
            });
        }
        
        // Change bet amount
        function changeBet(amount) {
            if (isSpinning) return;
            
            const newBet = currentBet + amount;
            if (newBet >= 1 && newBet <= balance) {
                currentBet = newBet;
                document.getElementById('current-bet').textContent = currentBet;
            }
        }
        
        // Spin the reels
        function spin() {
            if (isSpinning || currentBet > balance) return;
            
            isSpinning = true;
            document.getElementById('spin-btn').disabled = true;
            document.getElementById('win-message').textContent = '';
            
            // Deduct bet from balance
            balance -= currentBet;
            document.getElementById('balance').textContent = balance;
            
            // Spin each reel with optimized animation
            const spinPromises = reels.map((reel, index) => {
                return new Promise(resolve => {
                    const spinDuration = 1000 + Math.random() * 500; // Reduced duration (1-1.5s)
                    const spins = 5 + Math.floor(Math.random() * 5); // Reduced spins (5-10)
                    const totalHeight = symbols.length * 150 * 2; // 2 copies now
                    const endPosition = -(Math.floor(Math.random() * symbols.length) * 150 + (spins * totalHeight));
                    
                    const startTime = performance.now();
                    
                    function animate(currentTime) {
                        const elapsed = currentTime - startTime;
                        const progress = Math.min(elapsed / spinDuration, 1);
                        
                        // Ease-out function for slowing down at the end
                        const easedProgress = 1 - Math.pow(1 - progress, 3);
                        const currentPosition = reel.position + (endPosition - reel.position) * easedProgress;
                        reel.element.style.top = `${currentPosition % totalHeight}px`;
                        
                        if (progress < 1) {
                            requestAnimationFrame(animate);
                        } else {
                            reel.position = endPosition % totalHeight;
                            const symbolIndex = Math.abs(Math.floor(endPosition / 150) % symbols.length);
                            resolve(symbols[symbolIndex]);
                        }
                    }
                    
                    requestAnimationFrame(animate);
                });
            });
            
            // Check for win when all reels stop
            Promise.all(spinPromises).then(results => {
                checkWin(results);
                isSpinning = false;
                document.getElementById('spin-btn').disabled = false;
            });
        }
        
        // Enhanced win checking system
        function checkWin(results) {
            const [a, b, c] = results;
            let winAmount = 0;
            
            // Check for three matching symbols
            if (a === b && b === c) {
                const multipliers = {
                    '🍀': 2,
                    '🍇': 5,
                    '🔔': 10,
                    '🎰': 20
                };
                
                winAmount = currentBet * multipliers[a];
                winStreak++;
                
                // Bonus for consecutive wins
                if (winStreak > 1) {
                    winAmount = Math.floor(winAmount * (1 + winStreak * 0.2)); // 20% bonus per consecutive win
                }
            } 
            // Check for two matching symbols
            else if (a === b || a === c || b === c) {
                const matchingSymbol = a === b ? a : c;
                winAmount = Math.floor(currentBet * 0.5); // 0.5x bet for two matches
                winStreak = 0;
            } 
            // Special 7-7-any combination
            else if ((a === '7️⃣' && b === '7️⃣') || (a === '7️⃣' && c === '7️⃣') || (b === '7️⃣' && c === '7️⃣')) {
                winAmount = Math.floor(currentBet * 5); // 5x bet for two 7s
                winStreak = 0;
            } 
            else {
                winStreak = 0;
            }
            
            if (winAmount > 0) {
                balance += winAmount;
                document.getElementById('balance').textContent = balance;
                
                const winMessage = document.getElementById('win-message');
                winMessage.textContent = `You won $${winAmount}!${winStreak > 1 ? ` (${winStreak}x streak!)` : ''}`;
                winMessage.classList.add('win-animation');
                
                // Remove animation class after it completes
                setTimeout(() => {
                    winMessage.classList.remove('win-animation');
                }, 1500);
            }
        }
        
        // Initialize the game with optimized loading
        document.addEventListener('DOMContentLoaded', () => {
            initializeReels();
            
            // Pre-cache symbols for smoother animation
            setTimeout(() => {
                symbols.forEach(symbol => {
                    const test = document.createElement('div');
                    test.className = 'symbol';
                    test.textContent = symbol;
                    test.style.position = 'absolute';
                    test.style.visibility = 'hidden';
                    document.body.appendChild(test);
                });
            }, 100);
        });
    </script>
</body>
</html>
</html>